# Telegram Уведомления

## Обязательные переменные окружения

- `TELEGRAM_BOT_TOKEN` – токен бота из BotFather. Без него любые запросы к Bot API будут проигнорированы.
- `TELEGRAM_ADMIN_CHAT_ID` – чат администратора, куда падают уведомления, если нет менеджеров лодки.

## Как работают уведомления

1. При создании нового бронирования автоматически отправляется уведомление администраторам и менеджерам лодки.
2. При изменении статуса бронирования клиент получает уведомление (если у него заполнен `telegram_id`).
3. Уведомления отправляются через `server/utils/telegram-notifications.ts` используя общий клиент `server/utils/telegram-client.ts`.

## Типы уведомлений

### Для администраторов/менеджеров:
- Новое бронирование (обычное или групповое)
- Уведомления отправляются менеджерам лодки, если они назначены, иначе администратору

### Для клиентов:
- Подтверждение получения бронирования
- Изменение статуса бронирования (подтверждено/отменено)
- Напоминания о предстоящем бронировании

## Где смотреть логи

- **Локально:** терминал, где запущен `npm run dev`.
- **PM2:** `pm2 logs tgminiapp`.
- **Docker:** `docker logs <container>`.

Все ошибки отправки уведомлений выводятся в консоль сервера.

## Тестирование уведомлений

Используйте API endpoint `/api/telegram/test-notifications` для тестирования различных типов уведомлений.
