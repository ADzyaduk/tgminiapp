# Решение проблемы с переменными окружения Supabase в Amvera Cloud

## Проблема

Ошибка: `@supabase/ssr: Your project's URL and API key are required to create a Supabase client!`

При `ssr: false` переменные окружения должны быть доступны **во время сборки**, потому что весь код компилируется в статику.

## Решение

### Вариант 1: Передача переменных через Build Args (Рекомендуется)

1. **В Amvera Cloud добавьте переменные окружения:**
   - `SUPABASE_URL`
   - `SUPABASE_KEY` (или `SUPABASE_ANON_KEY`)
   - `SUPABASE_SERVICE_KEY`
   - И другие необходимые переменные

2. **Amvera Cloud должен автоматически передавать environment variables как build args**

3. **Проверьте логи сборки** - там должно быть видно, передаются ли переменные:
   ```
   === Checking environment variables ===
   ✅ SUPABASE_URL is set (length: XX)
   ✅ SUPABASE_KEY or SUPABASE_ANON_KEY is set
   ```

### Вариант 2: Если Amvera Cloud не передает build args автоматически

Если Amvera Cloud не передает environment variables как build args автоматически, вам нужно:

1. **Связаться с поддержкой Amvera Cloud** и уточнить, как передавать build args
2. **Или использовать другой подход** - передать переменные через другой механизм

### Вариант 3: Использование runtimeConfig (Не работает для ssr: false)

Для `ssr: false` это не сработает, потому что код компилируется в статику.

## Проверка

После сборки проверьте логи:
1. В логах сборки должно быть видно, передаются ли переменные
2. В консоли браузера должно появиться: `✅ Supabase конфигурация найдена`

## Что было сделано

1. ✅ Обновлен `Dockerfile` - добавлены ARG для переменных окружения
2. ✅ Добавлена проверка переменных во время сборки
3. ✅ Обновлен `nuxt.config.ts` - добавлен Vite define для переменных
4. ✅ Добавлен плагин `supabase-check.client.ts` - проверка конфигурации

## Важно

- Переменные **должны быть добавлены в Amvera Cloud ДО сборки**
- После добавления переменных **обязательно пересоберите проект**
- Проверьте логи сборки, чтобы убедиться, что переменные передаются

## Если проблема сохраняется

1. Проверьте логи сборки в Amvera Cloud
2. Убедитесь, что переменные добавлены правильно (без лишних пробелов)
3. Проверьте, что имена переменных точно совпадают (регистр важен!)
4. Свяжитесь с поддержкой Amvera Cloud для уточнения, как передавать build args

